<!doctype html>
<html
  dir="ltr"
  lang="en"
  data-theme=""
  
    class="html theme--light"
  
><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <title>
    Erik Westra (webstradev)
        |
        GitLab&#39;s semi-linear Git history
      

    

  </title>

  <meta name="generator" content="Hugo 0.127.0"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="author" content="Erik Westra (webstradev)" />
  <meta
    name="description"
    content="Erik Westra"
  />
  
  
    
    
    <link
      rel="stylesheet"
      href="/scss/main.min.59d93b79f93b987f0cd07339abbbba7273e9728a0409896ba2b2cd7cfccb3919.css"
      integrity="sha256-Wdk7efk7mH8M0HM5q7u6cnPpcooECYlrorLNfPzLORk="
      crossorigin="anonymous"
      type="text/css"
    />
  

  
  <link
    rel="stylesheet"
    href="/css/markupHighlight.min.73ccfdf28df555e11009c13c20ced067af3cb021504cba43644c705930428b00.css"
    integrity="sha256-c8z98o31VeEQCcE8IM7QZ688sCFQTLpDZExwWTBCiwA="
    crossorigin="anonymous"
    type="text/css"
  />
  
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css"
    integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css"
    integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css"
    integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link
    rel="stylesheet"
    href="/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css"
    integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc="
    crossorigin="anonymous"
    type="text/css"
  />
  
  <link rel="shortcut icon" href="/favicons/favicon.ico" type="image/x-icon" />
  <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png" />

  <link rel="canonical" href="http://localhost:1313/posts/semi-linear-git-history/" />

  
  
  
  
  <script
    type="text/javascript"
    src="/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js"
    integrity="sha256-&#43;RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI="
    crossorigin="anonymous"
  ></script>

  
    
    
    <script
      type="text/javascript"
      src="/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js"
      integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc="
      crossorigin="anonymous"
    ></script>
  

  

  


  
  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="GitLab&#39;s semi-linear Git history">
  <meta name="twitter:description" content="Photo by Yancy Min on Unsplash
Introduction Working with multiple developers on the same project can often result in messy git histories and unnecessary merge commits when updating feature branches from main.
Moreover, merge requests might not be based on the latest version of main when all CI checks pass and manual testing is done. This can result in CI passing on the merge request but failing once merged to main.">



  
  <meta property="og:url" content="http://localhost:1313/posts/semi-linear-git-history/">
  <meta property="og:site_name" content="WebstraDev Blog">
  <meta property="og:title" content="GitLab&#39;s semi-linear Git history">
  <meta property="og:description" content="Photo by Yancy Min on Unsplash
Introduction Working with multiple developers on the same project can often result in messy git histories and unnecessary merge commits when updating feature branches from main.
Moreover, merge requests might not be based on the latest version of main when all CI checks pass and manual testing is done. This can result in CI passing on the merge request but failing once merged to main.">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-05-18T21:23:17+02:00">
    <meta property="article:modified_time" content="2023-05-18T21:23:17+02:00">
    <meta property="article:tag" content="Git">
    <meta property="article:tag" content="Coding">
    <meta property="article:tag" content="Software-Engineering">



  
  
  
  
  <script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "articleSection": "posts",
        "name": "GitLab\u0027s semi-linear Git history",
        "headline": "GitLab\u0027s semi-linear Git history",
        "alternativeHeadline": "",
        "description": "
      
        Photo by Yancy Min on Unsplash\nIntroduction Working with multiple developers on the same project can often result in messy git histories and unnecessary merge commits when updating feature branches from main.\nMoreover, merge requests might not be based on the latest version of main when all CI checks pass and manual testing is done. This can result in CI passing on the merge request but failing once merged to main.


      


    ",
        "inLanguage": "en-us",
        "isFamilyFriendly": "true",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/semi-linear-git-history\/"
        },
        "author" : {
            "@type": "Person",
            "name": "Erik Westra (webstradev)"
        },
        "creator" : {
            "@type": "Person",
            "name": "Erik Westra (webstradev)"
        },
        "accountablePerson" : {
            "@type": "Person",
            "name": "Erik Westra (webstradev)"
        },
        "copyrightHolder" : {
            "@type": "Person",
            "name": "Erik Westra (webstradev)"
        },
        "copyrightYear" : "2023",
        "dateCreated": "2023-05-18T21:23:17.00Z",
        "datePublished": "2023-05-18T21:23:17.00Z",
        "dateModified": "2023-05-18T21:23:17.00Z",
        "publisher":{
            "@type":"Organization",
            "name": "Erik Westra (webstradev)",
            "url": "http://localhost:1313/",
            "logo": {
                "@type": "ImageObject",
                "url": "http:\/\/localhost:1313\/favicons\/favicon-32x32.png",
                "width":"32",
                "height":"32"
            }
        },
        "image": 
      [
      ]

    ,
        "url" : "http:\/\/localhost:1313\/posts\/semi-linear-git-history\/",
        "wordCount" : "1009",
        "genre" : [ ],
        "keywords" : [ 
      
      "git"

    
      
        ,

      
      "coding"

    
      
        ,

      
      "software-engineering"

    ]
    }
  </script>


</head>
<body class="body">
    <div class="wrapper">
      <aside
        
          class="wrapper__sidebar"
        
      ><div
  class="sidebar
    animated fadeInDown
  "
>
  <div class="sidebar__content">
    <div class="sidebar__introduction">
      <img
        class="sidebar__introduction-profileimage"
        src="/images/profile.jpg"
        alt="profile picture"
      />
      
        <div class="sidebar__introduction-title">
          <a href="/">webstradev</a>
        </div>
      
      <div class="sidebar__introduction-description">
        <p>Erik Westra</p>
      </div>
    </div>
    <ul class="sidebar__list">
      
        <li class="sidebar__list-item">
          <a
            href="https://link.webstra.dev/"
            target="_blank"
            rel="noopener me"
            aria-label="Linkedin"
            title="Linkedin"
          >
            <i class="fab fa-linkedin fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://git.webstra.dev/"
            target="_blank"
            rel="noopener me"
            aria-label="GitHub"
            title="GitHub"
          >
            <i class="fab fa-github fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="https://x.webstra.dev/"
            target="_blank"
            rel="noopener me"
            aria-label="twitter"
            title="twitter"
          >
            <i class="fab fa-twitter fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
        <li class="sidebar__list-item">
          <a
            href="mailto:erik@webstra.dev"
            target="_blank"
            rel="noopener me"
            aria-label="e-mail"
            title="e-mail"
          >
            <i class="fas fa-envelope fa-2x" aria-hidden="true"></i>
          </a>
        </li>
      
    </ul>
  </div><footer class="footer footer__sidebar">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Erik Westra (webstradev)
        2024
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></div>
</aside>
      <main
        
          class="wrapper__main"
        
      >
        <header class="header"><div
  class="
    animated fadeInDown
  "
>
  <a role="button" class="navbar-burger" data-target="navMenu" aria-label="menu" aria-expanded="false">
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
    <span aria-hidden="true" class="navbar-burger__line"></span>
  </a>
  <nav class="nav">
    <ul class="nav__list" id="navMenu">
      
      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/"
              
              title=""
              >Recent</a
            >
          </li>
        

      
        
        
          <li class="nav__list-item">
            
            <a
              
              href="/posts"
              
              title=""
              >All Posts</a
            >
          </li>
        

      
    </ul>
    <ul class="nav__list nav__list--end">
      
      
        <li class="nav__list-item">
          <div class="themeswitch">
            <a title="Switch Theme">
              <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a>
          </div>
        </li>
      
    </ul>
  </nav>
</div>
</header>
  <div
    class="post 
      animated fadeInDown
    "
  >
    
    <div class="post__content">
      <h1>GitLab&#39;s Semi-Linear Git History</h1>
      <p><img src="/images/clean-history.png" alt="clean history">
<em>Photo by <a href="https://unsplash.com/@yancymin?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Yancy Min</a> on <a href="https://unsplash.com/photos/842ofHC6MaI?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></em></p>
<h1 id="introduction">Introduction</h1>
<p>Working with multiple developers on the same project can often result in messy git histories and unnecessary merge commits when updating feature branches from main.</p>
<p>Moreover, merge requests might not be based on the latest version of main when all CI checks pass and manual testing is done. This can result in CI passing on the merge request but failing once merged to main. Or even features that were working when tested on the feature branch, that broke after being merged to main.</p>
<p>Lastly, a non-linear history results in commits from a feature branch being scattered on the main branch, ordered only by the commit&rsquo;s timestamp. This can make it hard to trace which commits were introduced in which order and makes it virtually impossible to check out previous commits without including various other unrelated changes.</p>
<p>In this post, we will take a look at some of the different merge strategies and how GitLab&rsquo;s semi-linear history can help you keep a much cleaner git history.</p>
<h1 id="a-non-linear-history">A non-linear history</h1>
<p>If a merge request MR#1 is based on an older version of main, the tests that run on the merge requests are not guaranteed to pass after being merged to main. This is because newer commits on main could conflict with or break code on MR#1 without necessarily having a merge conflict that prevents MR#1 from being merged.</p>
<p>Naturally, this could be solved by <em>always</em> merging <code>main</code> into a feature branch before creating a merge request. However, there are a few drawbacks to this merging strategy:</p>
<ul>
<li>
<p>It requires the developer to manually update their branch from main <em>locally</em> before creating a merge request. This can be forgotten or done incorrectly.</p>
</li>
<li>
<p>It Puts the responsibility of the branch being up to date on the developer, without an easy way to see this on a merge request.</p>
</li>
<li>
<p>It creates superfluous merge commits like Merge branch &lsquo;main&rsquo; into &lsquo;feature-1&rsquo;</p>
</li>
<li>
<p>Commits from different branches get entangled quickly because they are kept in order of time. This is easiest to explain visually. So I will demonstrate this below.</p>
</li>
</ul>
<p>Let&rsquo;s look at a straightforward git flow. Commits in blue are (merge) commits on main. The green and orange branches have the same root on main and are developed in parallel (simulating two developers working on different feature branches simultaneously). Furthermore, there is an extra commit on main (simulating a hotfix, a third branch being merged or something along those lines).</p>
<p><img src="/images/non-linear-example.png" alt="Non-Linear Example"></p>
<p>The merge request for feat/green is merged on Jan 7 and feat/orange is merged on Jan 10.
Before merging the feature branches were first updated from main which is necessary to ensure the CI on the merge request includes the latest commits on main.</p>
<p>With a standard non-linear history where branches are updated from main using <code>git merge</code> we would get something like this:</p>
<p><img src="/images/non-linear-example2.png" alt="Non-Linear Example #2"></p>
<p>The three main issues are that we have lost a bit of traceability on which commits belong together, it would be a lot harder to check out an earlier commit without also throwing out any commits that happened after that on different branches and lastly, we have created two unnecessary merge commits when updating our feature branches from <code>main</code>.</p>
<p>This can quite clearly make the git history difficult to read and manage without visual editors that draw all the diverging branches for you like <a href="https://www.gitkraken.com/">GitKraken</a>. Whilst being able to see the diverging branches on an editor can come in handy, it can also get hard to read very quickly if you don&rsquo;t keep a clean git history.</p>
<p><img src="/images/messy-history.png" alt="Messy Git History">
<em>A messy Git history. Source: <a href="https://stackoverflow.com/questions/804115/when-do-you-use-git-rebase-instead-of-git-merge?ref=workingsoftware.dev">When do you use Git rebase instead of Git merge?</a></em></p>
<p><em>One important thing to note is that these problems get considerably amplified when you increase the number of developers working on a repository or the time spent on a feature branch (or both).</em></p>
<hr>
<h1 id="a-semi-linear-history">A semi-linear history</h1>
<p>To solve the issues mentioned above, we can use GitLab&rsquo;s semi-linear history. This is a history where we update our feature branches from main using <code>git rebase</code> instead of <code>git merge</code>, but still merge feature branches into main with a <code>git merge</code> (resulting in a merge commit). This gives us a history where the commits from the feature branch are added on top of the latest commit on main with a merge commit so the entire merge can easily be reverted.</p>
<p>As you can see in the image below, commits still retain their actual commit dates; however, they are ordered based on when they were merged to <code>main</code>. This leads to a much cleaner git history while still preserving merge commits allowing for easy reverts and traceability.</p>
<p><img src="/images/non-vs-semi.png" alt="non-linear vs semi-linear">
<em>standard merge commits vs merge commit with semi-linear history</em></p>
<hr>
<h1 id="a-linear-history-fast-forward-merge">A linear history (fast-forward-merge)</h1>
<p>I&rsquo;m going to skim over this one rather quickly as I truly believe this is never the right way to go for any project that has more than one developer.</p>
<p>A fully linear history is a history where all commits are added on top of each other in a straight line. This can be achieved by keeping feature branches up to date with main using <code>git rebase</code> and then merging the feature branch into main using <code>git merge --ff-only</code>. This will result in a fast-forward merge where the commits from the feature branch are added on top of the latest commit on main.</p>
<p>GitLab has the option to enforce this, but I would advise against it. If you use this merge method, there will no longer be any merge commits on your <code>main</code> branch. This means you will no longer be able to revert all the commits from a single merge request in one action. Besides that, you won&rsquo;t be able to see any distinction between commits from different merge requests, unless you go onto the actual merge request on GitLab. If we go back to the example used above we would simply end up with a straight line with no merge commits and no way to tell which commits belong together (even in visual editors like GitKraken).</p>
<p><img src="/images/full-linear.png" alt="full-linear history">
<em>A full linear git history, otherwise known as &ldquo;Traceability Nightmare&rdquo;</em></p>
</div>
    <div class="post__footer">
      

      
        <span><a class="tag" href="/tags/git/">git</a><a class="tag" href="/tags/coding/">coding</a><a class="tag" href="/tags/software-engineering/">software-engineering</a></span>


      
    </div>

    
  </div>

      </main>
    </div><footer class="footer footer__base">
  <ul class="footer__list">
    <li class="footer__item">
      &copy;
      
        Erik Westra (webstradev)
        2024
      
    </li>
    
  </ul>
</footer>
  
  <script
    type="text/javascript"
    src="/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js"
    integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ="
    crossorigin="anonymous"
  ></script></body>
</html>
